!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("riot"));else if("function"==typeof define&&define.amd)define(["riot"],e);else{var r=e("object"==typeof exports?require("riot"):t.riot);for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(t,e,r){for(var n=!0;n;){var o=t,i=e,u=r;s=c=a=void 0,n=!1;var s=Object.getOwnPropertyDescriptor(o,i);if(void 0!==s){if("value"in s)return s.value;var a=s.get;return void 0===a?void 0:a.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;t=c,e=i,r=u,n=!0}},u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(1),a=console&&console.error||function(){},c=function(){function t(){o(this,t),s.router=this,s.observable(this),this.handler=new f,this.current=new y(new d("")),this.handleRequest=this.handleRequest.bind(this)}return u(t,[{key:"route",value:function(t){this.handler=t}},{key:"process",value:function(t){var e=new y(t);return this.handler.process(t,e),this.current=e,this.trigger("route:updated",e),e}},{key:"handleRequest",value:function(){var t=Array.prototype.slice.call(arguments);this.process(new d(t.join("/")))}},{key:"start",value:function(){s.route(this.handleRequest),s.route.start(),s.route.exec(this.handleRequest)}}]),t}(),h=function(){function t(){o(this,t)}return u(t,[{key:"matches",value:function(t){return!1}},{key:"process",value:function(t,e){var r=this.matches(t);return r?this.processMatch(t,e,r):this.processNotMatch(t,e)}},{key:"processMatch",value:function(t,e,r){return e.add(r),!0}},{key:"processNotMatch",value:function(t,e){return!1}},{key:"processRoutes",value:function(t,e,r){if(r&&r.length){for(var n=r.length,o=0;n>o;o++){var i=r[o];if(i.process(t,e))return!0}return!1}}}]),t}(),f=function(t){function e(t){o(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),t=t||{},this.tag=t.tag,this.path=t.path,this.name=t.name,this.pathParameterNames=[],this.pattern="^/?"+(this.path||this.name||this.tag||"").replace(/^\//,"").replace(/:([^\/]+)/,function(t,e){return this.pathParameterNames.push(e),"([^/]+)"}.bind(this))+"(:?/|$)",this.regex=new RegExp(this.pattern)}return n(e,t),u(e,[{key:"routes",value:function(t){var e=t.filter(function(t){return t instanceof v}),r=t.filter(function(t){return t instanceof g}),n=t.filter(function(t){return t instanceof l}),o=t.filter(function(t){return-1===e.indexOf(t)&&-1===r.indexOf(t)&&-1===n.indexOf(t)});return n.length>1&&a("Can't use more than one NotFoundRoute per route. --> "+(this.name||this.path||this.tag)),r.length>1&&a("Can't use more than one DefaultRoute per route. --> "+(this.name||this.path||this.tag)),this._routes=[].concat(e).concat(o).concat(r).concat(n),this}},{key:"matches",value:function(t){var e=this.regex.exec(t.uri);if(e){var r={};for(var n in this.pathParameterNames){var o=this.pathParameterNames[n];r[o]=e[parseInt(n,10)+1]}return{route:this,tag:this.tag,found:e[0],params:r}}return!1}},{key:"processMatch",value:function(t,r,n){var o=i(Object.getPrototypeOf(e.prototype),"processMatch",this).call(this,t,r,n);return this.processRoutes(t,r,n),o}},{key:"processRoutes",value:function(t,r,n){return i(Object.getPrototypeOf(e.prototype),"processRoutes",this).call(this,new p(t,n),r,this._routes)}}]),e}(h),p=function b(t,e){o(this,b),this.request=t,this.matcher=e,this.uri=this.request.uri.substring(e.found.length),this.parentUri=this.request.uri.substring(0,e.found.length)},l=function(t){function e(t){o(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),t=t||{},this.tag=t.tag}return n(e,t),u(e,[{key:"matches",value:function(t){return{route:this,tag:this.tag,found:t.uri}}}]),e}(h),v=function(t){function e(t){o(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),t=t||{},this.from=t.from,this.to=t.to,this.pattern="(^/?)"+this.from+"(/|$)",this.regex=new RegExp(this.pattern)}return n(e,t),u(e,[{key:"process",value:function(t,e){var r=t.uri.replace(this.regex,"$1"+this.to+"$2");if(r!==t.uri){var n=t.parentUri||"";e.uri=n+r,t.uri=r}}}]),e}(h),g=function(t){function e(t){o(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),t=t||{},this.tag=t.tag}return n(e,t),u(e,[{key:"matches",value:function(t){var e=t.uri.trim();return"/"===e||""===e?{route:this,tag:this.tag,found:e}:void 0}}]),e}(h),d=function x(t){o(this,x),this.uri=t},y=function(){function t(e){o(this,t),this.uri=e.uri,this.matches=[],this.params={}}return u(t,[{key:"add",value:function(t){this.matches.push(t);var e=t.params;if(e)for(var r in e)e.hasOwnProperty(r)&&(this.params[r]=e[r])}},{key:"get",value:function(t){return this.matches[t]}},{key:"size",value:function(){return this.matches.length}},{key:"isEmpty",value:function(){return this.matches.length}}]),t}();s.tag("route-empty","",function(t){}),s.tag("route",'<route-content name="content"></route-content>',function(t){this.calculateLevel=function(t){var e=0;return t.parent&&(e+=this.calculateLevel(t.parent)),t.opts.__router_level&&(e+=t.opts.__router_level),t.__router_tag&&(e+=1),e}.bind(this),this.mountTag=function(t,e){this.instance&&this.instance.forEach(function(t){t.unmount(!0)}),t&&(this.instance=s.mount(this.root.children[0],t,e))},this.updateRoute=function(){var t={tag:"route-empty"};if(s.router&&s.router.current){var e=s.router.current;if(this.level<=e.size()){var r=e.get(this.level);if(r){var n=JSON.parse(JSON.stringify(r.params||{}));n.__router_level=this.level,t={tag:r.tag,api:n}}}}this.mountTag(t.tag,t.api)}.bind(this),this.__router_tag="route",this.level=this.calculateLevel(this),s.router.on("route:updated",this.updateRoute),this.on("unmount",function(){s.router.off("route:updated",this.updateRoute)}.bind(this))});var m=new c;m.Route=f,m.DefaultRoute=g,m.RedirectRoute=v,m.NotFoundRoute=l,m._={Response:y,Request:d},s.router=m,t.exports=m},function(e,r,n){e.exports=t}])});
//# sourceMappingURL=router.min.js.map